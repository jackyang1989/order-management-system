# 已接受的差异 (Accepted Deviations)

> **版本**: v1.0
> **更新日期**: 2026-01-04
> **用途**: 记录经过评估后接受的原版与重构版差异

---

## 差异登记规则

1. 每个差异必须有唯一编号
2. 必须说明差异原因
3. 必须评估影响范围
4. 必须由审批人确认

---

## 已接受差异清单

### DEV-001: 字段命名风格差异

| 属性 | 值 |
|------|-----|
| **差异类型** | 命名规范 |
| **原版** | 下划线命名 (snake_case): `seller_task_id`, `create_time` |
| **重构版** | 驼峰命名 (camelCase): `sellerTaskId`, `createTime` |
| **差异原因** | TypeScript/JavaScript 社区惯例使用驼峰命名 |
| **影响范围** | 所有实体字段、API 响应 |
| **接受条件** | 数据库层保持原版命名，仅 API 层转换 |
| **审批日期** | 2026-01-04 |

---

### DEV-002: 时间戳表示方式差异

| 属性 | 值 |
|------|-----|
| **差异类型** | 数据格式 |
| **原版** | Unix 时间戳 (整数): `1642998733` |
| **重构版** | ISO 8601 字符串: `2022-01-24T10:12:13.000Z` |
| **差异原因** | 前端更易解析 ISO 格式，减少时区问题 |
| **影响范围** | 所有时间字段的 API 响应 |
| **接受条件** | 数据库存储保持时间戳，API 层转换格式 |
| **审批日期** | 2026-01-04 |

---

### DEV-003: API 路径结构差异

| 属性 | 值 |
|------|-----|
| **差异类型** | 接口设计 |
| **原版** | `admin/task/examineAgree` |
| **重构版** | `POST /batch/approve-tasks` |
| **差异原因** | RESTful 风格 API 设计 |
| **影响范围** | 所有 API 路径 |
| **接受条件** | 业务语义必须完全一致，仅路径格式不同 |
| **审批日期** | 2026-01-04 |

---

### DEV-004: 响应格式差异

| 属性 | 值 |
|------|-----|
| **差异类型** | 接口设计 |
| **原版** | `{ code: 1, msg: "成功", data: {...} }` |
| **重构版** | `{ success: true, message: "成功", data: {...} }` |
| **差异原因** | 更语义化的字段命名 |
| **影响范围** | 所有 API 响应 |
| **接受条件** | 核心数据结构必须一致 |
| **审批日期** | 2026-01-04 |

---

### DEV-005: 实体关联方式差异

| 属性 | 值 |
|------|-----|
| **差异类型** | 数据结构 |
| **原版** | 通过 ID 字段关联，手动 JOIN |
| **重构版** | TypeORM 实体关系，自动加载 |
| **差异原因** | ORM 框架最佳实践 |
| **影响范围** | 数据查询与返回 |
| **接受条件** | 返回的数据内容必须完整一致 |
| **审批日期** | 2026-01-04 |

---

## 差异评估模板

```markdown
### DEV-XXX: [差异标题]

| 属性 | 值 |
|------|-----|
| **差异类型** | [命名规范/数据格式/接口设计/业务逻辑/数据结构] |
| **原版** | [原版实现描述] |
| **重构版** | [重构版实现描述] |
| **差异原因** | [为什么产生差异] |
| **影响范围** | [影响哪些模块/功能] |
| **接受条件** | [在什么条件下接受此差异] |
| **审批日期** | [YYYY-MM-DD] |
```

---

## 禁止接受的差异类型

以下类型的差异必须拒绝，不得记录到本文件：

1. ❌ 状态值变更（如将 status=3 改为 status=2）
2. ❌ 状态机结构变更（新增/删除/合并状态）
3. ❌ 业务语义变更（改变接口的业务含义）
4. ❌ 权限边界变更（改变谁可以执行什么操作）
5. ❌ 金额计算逻辑变更
6. ❌ 删除原版存在的必填字段
