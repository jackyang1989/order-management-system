# 任务系统7个关键页面字段完整检查清单

## 检查范围说明

### 需要系统检查的7个页面：
1. **商家中心 - 任务详情页** (`/merchant/tasks/[id]/page.tsx`)
2. **管理后台 - 任务详情弹窗** (`/admin/tasks/page.tsx` 中的Modal)
3. **买手 - 任务详情页** (`/tasks/[id]/page.tsx`)
4. **买手 - 订单执行页** (`/orders/[id]/execute/page.tsx`)
5. **商家 - 订单管理/审核页** (`/merchant/orders/page.tsx`)
6. **管理后台 - 订单管理页** (`/admin/orders/page.tsx`)
7. **买手 - 任务领取页** (`/tasks/page.tsx` 的任务卡片)

### 发布时所有可配置字段清单（完整版）

根据发布页面代码，以下是所有可配置的字段：

---

## 一、第一步：基础信息字段（Step1BasicInfo.tsx）

### 1.1 平台选择
- [ ] `platform`: 淘宝 / 天猫 / 京东 / 拼多多

### 1.2 任务类型
- [ ] `taskType`: 关键词 / 淘口令 / 通道任务

### 1.3 店铺选择
- [ ] `storeId`: 店铺ID
- [ ] `storeName`: 店铺名称
- [ ] `storeAccount`: 店铺账号

### 1.4 返款方式
- [ ] `terminal` / `settlementMethod`: 本立佣货 / 本佣货返

### 1.5 商品列表 (goodsList)
每个商品包含：
- [ ] `goodsId`: 商品ID
- [ ] `name`: 商品名称
- [ ] `pcImg` / `image`: 商品图片
- [ ] `link`: 商品链接
- [ ] `price`: 下单价格
- [ ] `num`: 下单数量
- [ ] `isMain`: 主商品/副商品标识
- [ ] ⭐ **`orderSpecs`**: 下单规格设置数组
  - `specName`: 规格名称
  - `specValue`: 规格值
  - `quantity`: 数量
- [ ] `specName`: 商品规格名 (可能与orderSpecs重复)
- [ ] `specValue`: 商品规格值
- [ ] `verifyCode`: 核对口令

### 1.6 搜索关键词 (keywords)
每个关键词包含：
- [ ] `keyword`: 主关键词
- [ ] `usageCount`: 使用次数
- [ ] `terminal`: 终端 (1=PC, 2=移动)
- [ ] ⭐ **`compareKeyword`**: 货比关键词
- [ ] ⭐ **`backupKeyword`**: 备用关键词
- [ ] `sort`: 排序方式 (综合/销量/价格等)
- [ ] `province`: 发货地筛选
- [ ] `minPrice`: 最低价格
- [ ] `maxPrice`: 最高价格
- [ ] `discount`: 折扣筛选
- [ ] `filter`: 其他筛选条件

### 1.7 发布数量
- [ ] `count`: 任务单数

---

## 二、第二步：增值服务配置字段（Step2ValueAdded.tsx）

### 2.1 物流设置
- [ ] `isFreeShipping`: 商家包邮 / 不包邮
- [ ] ⭐ **`weight`**: 包裹重量 (kg)
- [ ] `shippingFee`: 运费（不包邮时）

### 2.2 下单提示
- [ ] ⭐ **`memo`** / **`orderTips`**: 下单提示内容 (最多100字)

### 2.3 浏览行为设置
- [ ] `needCompare`: 是否需要货比
  - [ ] ⭐ **`compareCount`**: 货比数量
- [ ] `needCollect`: 是否需要收藏商品
- [ ] `needFollow`: 是否需要关注店铺
- [ ] `needCart`: 是否需要加入购物车
- [ ] `needContactCS`: 是否需要联系客服
  - [ ] ⭐ **`contactCSContent`**: 联系客服沟通内容

### 2.4 浏览时长设置
- [ ] `browseTime`: 总浏览时长 (分钟)
- [ ] `compareBrowseTime`: 货比浏览时长 (分钟)
- [ ] `mainBrowseTime`: 主商品浏览时长 (分钟)
- [ ] `subBrowseTime`: 副商品浏览时长 (分钟) - 有副商品时才有效
- [ ] `hasSubProduct`: 是否有副商品 (控制副商品浏览时长显示)

### 2.5 好评设置
- [ ] ⭐ **`praiseList`** / **`reviews`**: 好评内容数组
  - 文字好评: 最多5条
  - [ ] `textReview1` ~ `textReview5`
- [ ] `imageReviews`: 图片好评 (可选)
- [ ] `videoReviews`: 视频好评 (可选)

### 2.6 其它增值服务

#### 2.6.1 口令验证
- [ ] ⭐ **`isPasswordEnabled`**: 是否开启口令验证
- [ ] ⭐ **`checkPassword`** / **`maskedPassword`**: 验证口令内容

#### 2.6.2 定时发布 (+1.0元/单)
- [ ] `isScheduledPublish`: 是否定时发布
- [ ] `publishTime`: 发布时间

#### 2.6.3 额外悬赏
- [ ] ⭐ **`extraCommission`** / **`addReward`**: 额外悬赏金额 (元/单)

#### 2.6.4 定时付款 (+1.0元/单)
- [ ] `isScheduledPayment`: 是否定时付款
- [ ] `paymentTime`: 付款时间

#### 2.6.5 延长买号周期 (+1.0元/月)
- [ ] `extendBuyerCycle`: 是否延长买号周期
- [ ] `cycleExtendDays`: 延长天数

#### 2.6.6 回购任务
- [ ] `isRepurchase`: 是否回购任务
- [ ] `repurchaseCondition`: 回购条件

#### 2.6.7 隔天任务 (+0.5元/单)
- [ ] `isNextDayTask`: 是否隔天任务
- [ ] `nextDayPayment`: 隔天付款要求

#### 2.6.8 快速返款服务 (商务费0.6%)
- [ ] ⭐ **`fastRefund`**: 是否快速返款
- [ ] `fastRefundFee`: 快速返款手续费

#### 2.6.9 任务接单间隔
- [ ] ⭐ **`orderInterval`** / **`unionInterval`**: 接单间隔时间 (分钟)

---

## 三、第三步：费用确认字段（Step3Payment.tsx）

### 3.1 费用明细
- [ ] `goodsPrice`: 单商品价格
- [ ] `goodsNum`: 单商品数量
- [ ] `goodsSubtotal`: 单商品小计 (price × num)
- [ ] `totalGoodsPrice`: 商品本金总计 (subtotal × count)
- [ ] `shippingFee`: 运费
- [ ] `deposit`: 商家保证金
- [ ] **`totalDeposit`**: 押金总计

- [ ] ⭐ **`baseCommission`**: 基础服务费 (元/单)
- [ ] ⭐ **`praiseCommission`**: 好评增值费 (元/单)
- [ ] ⭐ **`extraCommissionFee`**: 额外悬赏费用
- [ ] **`totalCommission`**: 银锭/佣金总计

- [ ] ⭐ **`totalAmount`**: 实付总额

### 3.2 账户余额
- [ ] `availableBalance`: 可用本金余额
- [ ] `availableSilver`: 可用银锭

---

## 四、7个页面字段显示检查表

### 页面1：商家中心 - 任务详情页

文件路径: `frontend/src/app/merchant/tasks/[id]/page.tsx`

#### 检查清单：

**基础信息区域**
- [ ] 任务编号
- [ ] 创建时间
- [ ] 平台
- [ ] 任务状态
- [ ] 结算方式 (terminal)
- [ ] 包邮状态

**商品信息区域**
- [ ] 商品图片
- [ ] 商品名称
- [ ] 店铺名称
- [ ] 下单价格
- [ ] 下单数量
- [ ] 商品小计
- [ ] ⭐ **下单规格设置 (orderSpecs)** - 显示每个规格的名称、值、数量
- [ ] 主/副商品标识
- [ ] 核对口令 (verifyCode)

**关键词信息区域**
- [ ] 进店方式 (关键词/淘口令/通道)
- [ ] ⭐ **主关键词内容**
- [ ] ⭐ **货比关键词**
- [ ] ⭐ **备用关键词**
- [ ] 关键词使用次数
- [ ] 关键词筛选设置 (排序、发货地、价格区间等)

**浏览要求区域**
- [ ] 货比 + ⭐ **货比数量(3家)**
- [ ] 收藏商品
- [ ] 关注店铺
- [ ] 加入购物车
- [ ] 联系客服 + ⭐ **沟通内容**
- [ ] 总浏览时长
- [ ] 货比浏览时长
- [ ] 主商品浏览时长
- [ ] 副商品浏览时长 (hasSubProduct判断)

**增值服务区域**
- [ ] ⭐ **包裹重量**
- [ ] ⭐ **下单提示**
- [ ] ⭐ **口令验证** (isPasswordEnabled + checkPassword)
- [ ] ⭐ **额外悬赏**
- [ ] 定时发布
- [ ] 定时付款
- [ ] 延长买号周期
- [ ] 回购任务
- [ ] 隔天任务
- [ ] ⭐ **快速返款**
- [ ] ⭐ **任务接单间隔**

**好评设置区域**
- [ ] ⭐ **文字好评列表** (显示具体内容，不是"未设置")
- [ ] 图片好评
- [ ] 视频好评

**费用明细区域**
- [ ] 商品本金 (单价 × 数量 × 单数)
- [ ] ⭐ **基础服务费** (明细)
- [ ] ⭐ **好评增值费** (明细)
- [ ] ⭐ **额外悬赏费** (明细)
- [ ] 运费
- [ ] 商家保证金
- [ ] 押金总计
- [ ] 佣金总计
- [ ] ⭐ **实付总额**

**任务进度区域**
- [ ] 总任务数 (count)
- [ ] 已领取数
- [ ] 已完成数
- [ ] 剩余可接数
- [ ] 完成进度百分比

---

### 页面2：管理后台 - 任务详情弹窗

文件路径: `frontend/src/app/admin/tasks/page.tsx` (Modal组件)

**需要显示所有与商家详情页相同的字段，外加：**
- [ ] 商家账号/名称
- [ ] 店铺账号/名称
- [ ] 审核状态
- [ ] 审核备注

检查清单与页面1完全相同，不再重复列出。

---

### 页面3：买手 - 任务详情页

文件路径: `frontend/src/app/tasks/[id]/page.tsx`

#### 检查清单：

**基础信息区域**
- [ ] 任务编号
- [ ] 平台
- [ ] 任务状态
- [ ] 结算方式
- [ ] 创建时间

**商品信息区域** (买手视角)
- [ ] 商品图片
- [ ] 商品名称
- [ ] 店铺名称
- [ ] 下单价格
- [ ] 下单数量
- [ ] ⭐ **下单规格设置** (重要！买手需要知道买什么规格)
- [ ] 核对口令 (verifyCode)

**搜索关键词区域** (买手视角 - 非常重要！)
- [ ] ⭐ **主关键词** (买手需要搜索的关键词)
- [ ] ⭐ **货比关键词** (货比时搜索的关键词)
- [ ] ⭐ **备用关键词** (主关键词找不到时的备选)
- [ ] 关键词筛选要求 (排序方式、价格区间等)

**任务要求区域**
- [ ] 包邮 / 不包邮
- [ ] ⭐ **包裹重量** (买手需要核对)
- [ ] ⭐ **下单提示** (重要！买手需要看到的注意事项)
- [ ] 货比要求 + 数量
- [ ] 收藏商品要求
- [ ] 关注店铺要求
- [ ] 加入购物车要求
- [ ] 联系客服要求 + ⭐ **沟通内容**
- [ ] 浏览时长要求 (总计/货比/主品/副品)

**佣金与返款信息** (买手关心)
- [ ] 垫付资金 (商品本金)
- [ ] 预计佣金 (基础 + 好评 + 额外)
- [ ] 结算方式 (本立佣货/本佣货返)
- [ ] ⭐ **快速返款标识** (买手关心能否快速拿到钱)
- [ ] ⭐ **额外悬赏标识** (吸引买手)

**好评要求区域**
- [ ] ⭐ **文字好评内容** (买手需要复制粘贴的好评文字)
- [ ] 图片好评要求
- [ ] 视频好评要求

**其他信息**
- [ ] ⭐ **口令验证提示** (是否需要找口令)
- [ ] 剩余可接数量

---

### 页面4：买手 - 订单执行页

文件路径: `frontend/src/app/orders/[id]/execute/page.tsx`

#### 检查清单：

**任务信息区域**
- [ ] 任务编号
- [ ] 平台
- [ ] 商家/店铺
- [ ] 结算方式
- [ ] ⭐ **快速返款标识**

**商品信息核对区域**
- [ ] 商品图片
- [ ] 商品名称
- [ ] 店铺名称
- [ ] 下单价格
- [ ] 下单数量
- [ ] ⭐ **下单规格设置** (买手需要严格按照这个下单！)
- [ ] 主/副商品标识

**搜索关键词区域** (执行指导)
- [ ] ⭐ **主关键词显示** (买手用这个搜索)
- [ ] ⭐ **货比关键词显示** (货比时用)
- [ ] ⭐ **备用关键词显示** (找不到时用)
- [ ] 关键词筛选设置 (排序、价格区间等)

**下单指导区域**
- [ ] ⭐ **下单提示** (重要提示信息)
- [ ] 商品链接核对输入框
- [ ] 商品口令核对输入框 (如果有verifyCode)
- [ ] 规格选择提示

**浏览任务区域**
- [ ] 货比任务 + 数量要求
- [ ] 收藏商品任务
- [ ] 关注店铺任务
- [ ] 加入购物车任务
- [ ] 联系客服任务 + ⭐ **沟通内容显示**
- [ ] 浏览时长倒计时/提示

**物流信息区域**
- [ ] 包邮/不包邮
- [ ] ⭐ **包裹重量** (买手需要核对包裹重量)
- [ ] 收货地址填写

**支付信息区域**
- [ ] 应付金额
- [ ] 垫付资金
- [ ] 预计佣金

**好评提交区域**
- [ ] ⭐ **文字好评内容显示** (买手可以直接复制)
- [ ] 图片好评上传 (如果需要)
- [ ] 视频好评上传 (如果需要)

**订单提交区域**
- [ ] 订单号输入
- [ ] 订单截图上传
- [ ] 聊天记录截图上传 (如果需要联系客服)

---

### 页面5：商家 - 订单管理/审核页

文件路径: `frontend/src/app/merchant/orders/page.tsx`

#### 检查清单：

**订单列表区域**
- [ ] 订单编号
- [ ] 任务编号
- [ ] 买手账号
- [ ] 商品信息
- [ ] 订单状态
- [ ] 创建时间

**订单详情/审核弹窗**
- [ ] 任务编号
- [ ] 买手信息
- [ ] 商品信息 (名称、价格、数量)
- [ ] ⭐ **下单规格** (商家审核时需要核对)
- [ ] 订单号
- [ ] 订单截图
- [ ] 浏览任务完成情况
  - [ ] 货比完成
  - [ ] 收藏完成
  - [ ] 关注完成
  - [ ] 购物车完成
  - [ ] 客服沟通完成 + 聊天记录
- [ ] 浏览时长完成情况
- [ ] 好评提交情况
  - [ ] ⭐ **文字好评内容** (商家审核)
  - [ ] 图片好评 (如果有)
  - [ ] 视频好评 (如果有)
- [ ] 物流信息
  - [ ] 收货地址
  - [ ] ⭐ **包裹重量** (商家需要核对)
- [ ] 审核操作
  - [ ] 通过按钮
  - [ ] 驳回按钮 + 驳回原因

---

### 页面6：管理后台 - 订单管理页

文件路径: `frontend/src/app/admin/orders/page.tsx`

#### 检查清单：

**与商家订单管理页类似，外加：**
- [ ] 商家信息
- [ ] 店铺信息
- [ ] 任务完整信息 (所有字段)
- [ ] 费用明细
  - [ ] 商品本金
  - [ ] 基础服务费
  - [ ] 好评增值费
  - [ ] 额外悬赏
  - [ ] 平台抽成/手续费
- [ ] 资金流水记录

---

### 页面7：买手 - 任务领取页 (任务卡片)

文件路径: `frontend/src/app/tasks/page.tsx`

#### 检查清单：

**任务卡片显示**
- [ ] 任务编号 (可选)
- [ ] 平台图标/名称
- [ ] 商家名称 (完整显示，不是"...")
- [ ] 商品缩略图
- [ ] 商品名称 (截断显示)
- [ ] ⭐ **垫付资金** (当前显示空值，必须修复！)
- [ ] ⭐ **预计佣金** (当前显示++NaN，必须修复！)
- [ ] 结算方式标识
- [ ] 任务类型标识 (关键词/淘口令/通道)
- [ ] ⭐ **增值服务标识**
  - [ ] 快速返款图标/标签
  - [ ] 额外悬赏金额显示
  - [ ] 口令验证标识
- [ ] 剩余任务数量
- [ ] "添加任务单"按钮

---

## 五、未选择配置项的显示逻辑检查

### 5.1 可选配置项清单及其显示逻辑

| 配置项 | 字段名 | 未选择时的值 | 应该显示 | 当前是否正确 |
|--------|--------|------------|---------|------------|
| **增值服务** |
| 货比 | needCompare | false | 不显示货比相关内容 | ? |
| 货比数量 | compareCount | 0 或 null | 不显示 (needCompare=false时) | ? |
| 收藏商品 | needCollect | false | 不显示收藏标签 | ? |
| 关注店铺 | needFollow | false | 不显示关注标签 | ? |
| 加入购物车 | needCart | false | 不显示购物车标签 | ? |
| 联系客服 | needContactCS | false | 不显示客服标签 | ? |
| 联系客服内容 | contactCSContent | null | 不显示 (needContactCS=false时) | ? |
| 口令验证 | isPasswordEnabled | false | 不显示口令相关内容 | ? |
| 定时发布 | isScheduledPublish | false | 不显示定时发布信息 | ? |
| 额外悬赏 | extraCommission | 0 或 null | 不显示或显示"无" | ⚠️ 当前可能有问题 |
| 定时付款 | isScheduledPayment | false | 不显示定时付款信息 | ? |
| 延长买号周期 | extendBuyerCycle | false | 不显示延长周期信息 | ? |
| 回购任务 | isRepurchase | false | 不显示回购标识 | ? |
| 隔天任务 | isNextDayTask | false | 不显示隔天任务标识 | ? |
| 快速返款 | fastRefund | false | 不显示快速返款标识 | ❌ 当前完全未显示 |
| 任务接单间隔 | orderInterval | 0 或 null | 不显示或显示默认值 | ❌ 当前完全未显示 |
| **物流设置** |
| 包邮 | isFreeShipping | true (默认) | 显示"包邮" | ✅ |
| 不包邮 | isFreeShipping | false | 显示"不包邮"+"运费" | ? |
| 包裹重量 | weight | 0 | 显示"0kg"或不显示 | ❌ 当前完全未显示 |
| **好评设置** |
| 文字好评 | praiseList | [] 或 null | 显示"未设置" | ⚠️ 当前显示错误(有内容却显示未设置) |
| 图片好评 | imageReviews | [] 或 null | 显示"未设置" | ✅ |
| 视频好评 | videoReviews | [] 或 null | 显示"未设置" | ✅ |
| **下单提示** |
| 下单提示 | memo/orderTips | null 或 "" | 不显示或显示"无" | ❌ 当前完全未显示 |
| **副商品** |
| 副商品 | goodsList[isMain=false] | 不存在 | 不显示副商品相关内容 | ⚠️ 副商品浏览时长显示错误 |
| 副商品浏览时长 | subBrowseTime | 0 或 有值但无副商品 | 不显示 (hasSubProduct=false时) | ❌ 当前错误显示2分钟 |

### 5.2 关键显示逻辑检查点

#### 检查点1: hasSubProduct 逻辑
```typescript
const hasSubProduct = goodsList.some(g => !g.isMain);
// 只有 hasSubProduct === true 时才显示副商品浏览时长
```
**当前状态**: ❌ 没有副商品却显示2分钟

#### 检查点2: 费用计算逻辑
```typescript
// 预计佣金 = 基础服务费 + 好评增值费 + 额外悬赏
const totalCommission = baseCommission + (praiseList.length > 0 ? praiseCommission : 0) + (extraCommission || 0);
```
**当前状态**: ❌ 显示++NaN或¥5.50 (错误)

#### 检查点3: orderSpecs 显示逻辑
```typescript
// orderSpecs 是 JSON string，需要 parse
const specs = JSON.parse(orderSpecs);
// 显示: specs.map(s => `${s.specName}: ${s.specValue} × ${s.quantity}`)
```
**当前状态**: ❌ 完全未显示

#### 检查点4: keywords 显示逻辑
```typescript
// keywords 是关联表数据，需要显示
// 主关键词: keywords[0].keyword
// 货比关键词: keywords[0].compareKeyword (如果有)
// 备用关键词: keywords[0].backupKeyword (如果有)
```
**当前状态**: ❌ 只显示"关键词"标签，未显示具体内容

---

## 六、系统检查执行计划

### 第一步：代码审查 (预计2-3小时)
逐个检查7个页面的代码：
1. 读取页面组件代码
2. 检查数据接口调用
3. 检查字段渲染逻辑
4. 标注缺失/错误的字段

### 第二步：后端API验证 (预计1小时)
1. 检查 tasks.service.ts 中的数据返回
2. 确认所有字段都正确保存和返回
3. 修复费用计算逻辑

### 第三步：生成修复清单 (预计30分钟)
为每个页面生成：
- 需要添加的字段列表
- 需要修复的逻辑列表
- 优先级排序

### 第四步：执行修复 (预计1-2天)
按P0 → P1 → P2优先级依次修复

### 第五步：全链路测试 (预计半天)
测试任务发布 → 详情查看 → 领取 → 执行 → 审核全流程

---

## 七、下一步行动

请确认是否开始系统检查，我将：

1. ✅ 逐个读取7个页面的完整代码
2. ✅ 对比每个字段的显示情况
3. ✅ 生成详细的缺失/错误报告
4. ✅ 生成优先级排序的修复清单
5. ✅ 确保所有未选择的配置项也有正确的显示逻辑

**你的要求我理解正确吗？需要我现在开始系统检查所有7个页面吗？**
